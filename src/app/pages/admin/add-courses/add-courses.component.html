<!-- {{colleges|json}} -->



<form [formGroup]="programForm" (ngSubmit)="submitForm()" class="container-fluid">
  <div class="card">
    <div class="card-header">
      <div class="card-title">Add University Program</div>
    </div>
    <div class="card-body">
      <!-- First Row -->
      <div class="row">
        <div class="form-group col-12 col-md-6">
          <label for="programName">Program Name</label>
          <input type="text" class="form-control" id="programName" formControlName="programName"
            placeholder="Enter Program Name" />
          <div *ngIf="programForm.get('programName')?.touched && programForm.get('programName')?.invalid">
            <small *ngIf="programForm.get('programName')?.errors?.['required']" class="text-danger">
              Program name is required.
            </small>
            <small *ngIf="programForm.get('programName')?.errors?.['minlength']" class="text-danger">
              Minimum 3 characters.
            </small>
          </div>
        </div>

        <div class="form-group col-12 col-md-6">
          <label for="uniType">Select University Type</label>
          <select class="form-select" (change)="filterUniversities()" id="uniType" formControlName="uniType">
            <option value="">-- All --</option>
            <option value="PUBLIC">PUBLIC</option>
            <option value="PRIVATE">PRIVATE</option>
          </select>
          <div *ngIf="programForm.get('uniType')?.touched && programForm.get('uniType')?.invalid">
            <small class="text-danger">Please select a university type.</small>
          </div>
        </div>
      </div>

      <!-- Second Row -->
      <div class="row">
        <div class="form-group col-12 col-md-6">
          <label for="universityId">University</label>
          <select class="form-select" id="universityId" formControlName="universityId">
            <option value="">-- Select University --</option>
            <option *ngFor="let uni of filteredUniversities" [value]="uni.id">{{ uni.name }}</option>
          </select>
        </div>

        <!-- <div class="form-group col-12 col-md-6">
          <label for="category">Category</label>
          <select class="form-select" id="category" (change)="onCategoryChange($event)">
            <option value="">-- Select Category --</option>
            <option *ngFor="let cat of objectKeys(categories)" [value]="cat">{{ cat }}</option>
          </select>
        </div> -->



        <div class="form-group col-12 col-md-6">
          <label for="category">Category</label>
          <select class="form-select" id="category" formControlName="categoryIds" (change)="onCategoryChange($event)">
            <option value="">-- Select Category --</option>
            <option *ngFor="let cat of colleges" [value]="cat.id">{{ cat.name }}</option>
          </select>
          <div *ngIf="programForm.get('categoryIds')?.touched && programForm.get('categoryIds')?.invalid">
            <small class="text-danger">Category is Required.</small>
            </div>
        </div>
      </div>

      <!-- Cutoff Points Section -->
      <div formArrayName="cutoffPoints" class="mt-3">
        <div *ngFor="let group of cutoffPoints.controls; let i = index" [formGroupName]="i" class="row mb-2 g-2">
          <div class=" col-sm-5">
            <select class="form-select" formControlName="subject">
              <option value="">-- Select Subject --</option>
              <option *ngFor="let s of combinedSubjects" [value]="s">{{ s }}</option>
            </select>
          </div>

          <div class="col-12 col-sm-5">
            <select class="form-select" formControlName="grade">
              <option value="">-- Select Grade --</option>
              <option *ngFor="let g of grades" [value]="g">{{ g }}</option>
            </select>
          </div>

          <div class="col-12 col-sm-2 d-flex align-items-center justify-content-center">
            <button type="button" class="btn btn-danger w-100" (click)="removeSubject(i)">Remove</button>
          </div>
        </div>
      </div>

      <!-- Add/Submit Buttons -->
      <div class="row mt-3">
        <div class="col-6">
          <button type="button" class="btn btn-secondary w-100" (click)="addSubject()">+ Add Subject</button>
        </div>
        <div class="col-6">
          <button type="submit" class="btn btn-primary w-100">Submit Program</button>
        </div>
      </div>
    </div>
  </div>
</form>



























<hr>